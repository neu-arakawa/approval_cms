var ArticleEditor=function(){function F(e,t){var i=$(e);if(!i.closest("form").length)return alert("[ArticleEditor] 指定の要素がフォーム要素に含まれないため、正常に動作しません"),null;var o,u=this,n={maxFileSize:"2MB",types:["big-heading","mid-heading","small-heading","text","image","image-kmu","vs-image","link","link-kmu","list","list-kmu","list-link-kmu","table","html","youtube"],typeNames:{"big-heading":"大見出し","mid-heading":"中見出し","small-heading":"小見出し",text:"テキスト",image:"画像","image-kmu":"画像",link:"リンク","link-kmu":"リンク",list:"リスト","list-kmu":"リスト","list-link-kmu":"リンク",table:"表組み",html:"HTML",youtube:"YouTube","vs-image":"画像(横2列)"},allowCssClass:!1,allowImageAlt:!1,bigHeadingTag:"h3",midHeadingTag:"h4",smallHeadingTag:"h5",textTag:"p",imageTag:"div",imageTagClass:"image-wrap",linkTag:"div",linkTagClass:"link-wrap",listTag:"ul",tableTag:"table",tableDefaultColNum:2,tableMaxRow:50,tableMaxCol:10,htmlTag:"div",htmlTagClass:"html-wrap",wholeWrapTag:"div",wholeWrapTagClass:"ve",imageTypes:["jpg","jpeg","jpe","gif","png"],fileTypes:["pdf","doc","docx","xls","xlsx","ppt","pptx","txt","zip","mp4","jpg","jpeg","jpe","gif","png"],imgPlaceholderText:"回り込みテキストを入力します。回り込みテキストを入力します。回り込みテキストを入力します。回り込みテキストを入力します。回り込みテキストを入力します。回り込みテキストを入力します。",maxTextAreaHeight:400,uploaderDomain:null,uploaderPath:"/uploader",uploaderDir:"/",inlineVe:!0,allowHtmlInText:!1,veStyleFormats:[],onLoad:null,onUpdate:null,updateInterval:0},a=(this.options=W(n),null),s=null,l=null;for(o in t)this.options[o]=t[o];for(o in n){var r="data-"+o.replace(/[A-Z]/g,function(t){return"-"+t.charAt(0).toLowerCase()}),r=i.attr(r);if(r){r=r.replace(/\'/g,'"');try{r=JSON.parse(r)}catch(t){}finally{this.options[o]=r}}}this.options.uploaderPath.match(/\/$/)||(this.options.uploaderPath=this.options.uploaderPath+"/"),this.options.uploaderDir.match(/^(\/*)(.*?)(\/*)$/)&&(this.options.uploaderDir=RegExp.$2),this.options.uploaderDomain&&this.options.uploaderDomain.match(/^(.*?)(\/*)$/)&&(this.options.uploaderDomain=RegExp.$1);var n={data:function(){return{dragging:!1}},computed:{isCssClassEnabled:function(){return u.options.allowCssClass}},methods:{onLabelDragstart:function(t){t.dataTransfer.setData("text","element"),t.dataTransfer.effectAllowed="move",this.dragging=!0,this.$emit("item-dragstart",this.item)},onLabelDragend:function(t){this.dragging=!1,this.$emit("item-dragend",this.item)},onLabelDrop:function(){this.$emit("item-drop",this.item)},onSeparatorClick:function(t,e){this.$emit("separator-click",this.item,e)},onItemDelete:function(t){this.$emit("item-delete",this.item)}}},d={template:'<div class="separator" v-bind:class="{dragover:dragover}" v-on:click.prevent.stop="onClick" v-on:dragover.prevent.stop="onDragover" v-on:dragleave="onDragleave" v-on:drop.prevent.stop="onDrop"><button tabindex="-1"><span>挿入</span></button></div>',data:function(){return{dragover:!1}},methods:{onClick:function(t){this.$emit("separator-click",null,t)},onDragover:function(t){if(!a)return!1;this.dragover=!0,t.dataTransfer.dropEffect="move"},onDragleave:function(t){if(!a)return!1;this.dragover=!1},onDrop:function(t){if(!a)return!1;this.dragover=!1,this.$emit("label-drop-on-separator")}}},p='<div class="item-menu" v-bind:class="[data.direction,{show: data.show}]"><ul>',c=(u.options.types.forEach(function(t){var e=u.options.typeNames[t];p+='<li data-type="'+t+'" v-on:click="onMenuClick">'+e+"</li>"}),{template:p+="</ul></div>",props:["data"],computed:{},mounted:function(){this.data.size.width=this.$el.clientWidth,this.data.size.height=this.$el.clientHeight},methods:{onMenuClick:function(t){t=$(t.target).attr("data-type");this.$emit("menu-click",t)}}}),m={template:'<div class="ve"              contenteditable="false"              v-bind:class="{placeholded: placeholded}"              v-on:input="onTextChange"              v-on:blur="onBlur"              v-on:focus="onFocus"              ref="inputElement"></div>',props:["text","isPlaceholderEnabled"],data:function(){return{placeholded:!1,veMenuSelector:".mce-tinymce"}},created:function(){},mounted:function(){var t=$(this.$refs.inputElement);this.text?t.html(this.text):t.html("<br>"),u.options.inlineVe&&this.loadTinyMCE(),this.onBlur()},computed:{},methods:{init:function(){var e=this,t="undo redo | link unlink | removeformat",i=u.options.veStyleFormats,o=(i.length&&(t="styleselect link unlink | removeformat"),0),a=setInterval(function(){var n;"undefined"!=typeof tinymce&&(n=u.options.uploaderPath,u.options.uploaderDir&&(n+="#"+u.options.uploaderDir),tinymce.init({target:e.$el,theme:"inlite",skin:"custom",language:"ja",menubar:!1,statusbar:!1,plugins:"link paste",insert_toolbar:"",selection_toolbar:t,inline:!0,paste_as_text:!0,paste_data_images:!1,forced_root_block:!1,keep_styles:!1,hidden_input:!1,content_css:[],branding:!1,elementpath:!1,style_formats:i,convert_urls:!1,relative_urls:!0,init_instance_callback:function(t){clearInterval(a),e.$emit("ve-init")},file_browser_callback:function(e,t,i,o){return tinymce.activeEditor.windowManager.open({file:n,title:"ファイルのアップロード・選択",width:.85*window.innerWidth,height:.75*window.innerHeight,resizable:"yes"},{setUrl:function(t){o.document.getElementById(e).value=t}}),!1}})),20<=++o&&clearInterval(a)},500)},onTextChange:function(t){var e=$(this.$refs.inputElement).html();this.$emit("input",e)},onFocus:function(t){this.$emit("focus");var e=$(this.$refs.inputElement);this.isPlaceholderEnabled&&e.text()===u.options.imgPlaceholderText&&(this.placeholded=!1,e.html("<br>"))},onBlur:function(t){this.onTextChange(t),this.$emit("blur");var e=$(this.$refs.inputElement);this.isPlaceholderEnabled&&!e.text()&&(this.placeholded=!0,setTimeout(function(){e.html(u.options.imgPlaceholderText)},0))},loadTinyMCE:function(){var t=this;"undefined"==typeof tinymce?B(H+"lib/tinymce/tinymce.min.js",function(){t.init(t)}):t.init(t)}}},g={template:'  <div class="item-wrap">    <div class="item text" v-bind:class="[item.type, {dragging:dragging}]">      <div class="col1">        <label v-on:dragstart="onLabelDragstart" v-on:dragend="onLabelDragend" draggable="true">{{labelName}}</label>      </div>      <div class="col2">        <div class="class-wrap" v-if="isCssClassEnabled">          <label :for="item.id+\'_css\'">CSSクラス</label>          <input type="text" v-model="item.className" :id="item.id+\'_css\'" />        </div>        <textarea v-model="item.text" v-on:input="onInput" ref="inputElement" />      </div>      <div class="col3"><button v-on:click.prevent="onItemDelete" tabindex="-1"><span>削除</span></button></div>    </div>    <separator v-on:label-drop-on-separator="onLabelDrop" v-on:separator-click="onSeparatorClick" />  </div>',props:["item"],components:{separator:d},mixins:[n],mounted:function(){var t,e=this.$refs.inputElement;document.createEvent?((t=document.createEvent("HTMLEvents")).initEvent("input",!0,!0),e.dispatchEvent(t)):(t=document.createEventObject(),e.fireEvent("oninput",t))},computed:{labelName:function(){return u.options.typeNames[this.item.type]}},methods:{onInput:function(t){var e,i=window.getComputedStyle(t.target),o=i.lineHeight.split("px")[0];i.paddingTop.split("px")[0],i.paddingBottom.split("px")[0];if(t.target.scrollHeight>t.target.offsetHeight)t.target.style.height=t.target.scrollHeight+3+"px";else for(;;){if(e=t.target.style.height.split("px")[0],t.target.style.height=e-o+"px",t.target.scrollHeight>t.target.offsetHeight){t.target.style.height=t.target.scrollHeight+3+"px";break}break}}}},v={template:'  <div class="item-wrap">    <div class="item image ve-text" v-bind:class="{\'ve-unload\': !item.veInited, dragging:dragging}">      <div class="col1">        <label v-on:dragstart="onLabelDragstart" v-on:dragend="onLabelDragend" draggable="true">テキスト</label>        <div class="align">          <input type="radio" value="left" v-model="item.align" v-bind:id="randomID[0]" /><label v-bind:for="randomID[0]"></label>          <input type="radio" value="center" v-model="item.align" v-bind:id="randomID[1]" /><label v-bind:for="randomID[1]"></label>          <input type="radio" value="right" v-model="item.align" v-bind:id="randomID[2]" /><label v-bind:for="randomID[2]"></label>        </div>      </div>      <div class="col2" v-bind:class="item.align">        <div class="class-wrap" v-if="isCssClassEnabled">          <label :for="item.id+\'_css\'">CSSクラス</label>          <input type="text" v-model="item.className" :id="item.id+\'_css\'" />        </div>        <visualeditor          v-bind:text=item.text          v-bind:isPlaceholderEnabled=false          v-on:input="onTextChange"          v-on:ve-init="onVEInit" />      </div>      <div class="col3"><button v-on:click.prevent="onItemDelete" tabindex="-1"><span>削除</span></button></div>    </div>    <separator v-on:label-drop-on-separator="onLabelDrop" v-on:separator-click="onSeparatorClick" />  <div>',props:["item"],data:function(){return{randomID:[]}},created:function(){},components:{visualeditor:m,separator:d},mixins:[n],mounted:function(){for(var t=0;t<3;t++)this.randomID.push("image-align-"+P(6,"numeric"))},computed:{labelName:function(){return u.options.typeNames[this.item.type]}},methods:{onTextChange:function(t){this.item.text=t},onVEInit:function(){this.item.veInited=!0}}},h={template:'  <div class="item-wrap">    <div class="item image" v-bind:class="{\'ve-unload\': !item.veInited, nofile: !item.image, dragover:dragover, dragging:dragging, focus:focus}" v-on:dragover.prevent.stop="onDragover" v-on:dragleave="onDragleave" v-on:drop.prevent.stop="onDrop">      <div class="loading" v-if="isLoadingFile"><div class="progress-wrap"><div class="progress" v-bind:style="{width: uploadProgress + \'%\'}"></div></div></div>      <div class="col1">        <label v-on:dragstart="onLabelDragstart" v-on:dragend="onLabelDragend" draggable="true">画像</label>        <div class="align">          <input type="radio" value="left" v-model="item.align" v-bind:id="randomID[0]" /><label v-bind:for="randomID[0]"></label>          <input type="radio" value="center" v-model="item.align" v-bind:id="randomID[1]" /><label v-bind:for="randomID[1]"></label>          <input type="radio" value="right" v-model="item.align" v-bind:id="randomID[2]" /><label v-bind:for="randomID[2]"></label>        </div>      </div>      <div class="col2">        <div class="class-wrap" v-if="isCssClassEnabled">          <label :for="item.id+\'_css\'">CSSクラス</label>          <input type="text" v-model="item.className" :id="item.id+\'_css\'" />        </div>        <div class="dnd" v-if="isDndSupported" v-on:dblclick="selectFile">          <div class="msg">画像をドラッグ＆ドロップ</div>        </div>        <div class="content">          <div class="img" v-bind:class="item.align">            <img v-bind:src="item.image" v-on:dblclick="selectFile" draggable="false" />          </div>          <component            v-bind:is="inputComponent"            v-bind:isPlaceholderEnabled=true            class="text"            v-bind:text=item.text            v-on:input="onTextChange"            v-on:ve-init="onVEInit"            v-on:focus="onFocus"            v-on:blur="onBlur" />        </div>        <div class="alt-wrap" v-if="isAltEnabled">          <label :for="item.id+\'_alt\'">ALT</label>          <input type="text" v-model="item.altName" :id="item.id+\'_alt\'" />        </div>        <button class="remove" tabindex="-1" v-on:click.prevent="onFileDelete">画像をクリア</button>        <button class="uploader" tabindex="-1" v-on:click.prevent="selectFile">アップロード済みの画像から選択</button>      </div>      <div class="col3"><button v-on:click.prevent="onItemDelete" tabindex="-1"><span>削除</span></button></div>    </div>    <separator v-on:label-drop-on-separator="onLabelDrop" v-on:separator-click="onSeparatorClick" />  </div>',props:["item"],data:function(){return{randomID:[],dragover:!1,isDndSupported:!u.options.uploaderDomain,isLoadingFile:!1,uploadProgress:0,inputComponent:u.options.inlineVe?"visualeditor":"plaintexteditor",focus:!1}},components:{visualeditor:m,plaintexteditor:M={template:'<div contenteditable="true" v-bind:class="{placeholded: placeholded}" v-on:input="onTextChange" v-on:focus="onFocus" v-on:blur="onBlur" v-on:paste.prevent="onTextPaste" ref="inputElement"></div>',props:["text","isPlaceholderEnabled"],data:function(){return{placeholded:!1}},created:function(){},mounted:function(){var t=$(this.$refs.inputElement);this.text?t.html("<p>"+this.text+"</p>"):t.html("<br>"),this.onBlur()},computed:{},methods:{onTextChange:function(t){this.$emit("input",$(this.$refs.inputElement).html())},onFocus:function(t){this.$emit("focus");var e=$(this.$refs.inputElement);this.isPlaceholderEnabled&&e.text()===u.options.imgPlaceholderText&&(this.placeholded=!1,e.html("<br>"))},onBlur:function(t){this.onTextChange(t),this.$emit("blur");var e=$(this.$refs.inputElement);this.isPlaceholderEnabled&&!e.text()&&(this.placeholded=!0,setTimeout(function(){e.html(u.options.imgPlaceholderText)},0))},onTextPaste:function(t){var e,i,t=window.clipboardData?window.clipboardData.getData("text"):t.clipboardData.getData("text/plain");document.selection?(i=document.selection.createRange()).text=t:(i=(e=window.getSelection()).getRangeAt(0),t=document.createTextNode(t),i.deleteContents(),i.insertNode(t),e.removeAllRanges())}}},separator:d},mixins:[n],created:function(){},mounted:function(){for(var t=0;t<3;t++)this.randomID.push("image-align-"+P(6,"numeric"))},computed:{isAltEnabled:function(){return u.options.allowImageAlt}},methods:{canDrop:function(){return this.isDndSupported&&!a},selectFile:function(t){return F.showUploader(u.options.uploaderDomain,u.options.uploaderPath,u.options.uploaderDir,this.setImage),!1},onTextChange:function(t){this.item.text=t},setImage:function(t){var e=u.options.imageTypes;if(t&&e){var i=new RegExp(".("+e.join("|")+")$");if(!t.match(i))return alert("画像の種類は "+e.join("・")+" のいずれかである必要があります"),!1}this.item.image=t},onFileDelete:function(){if(!confirm("画像をクリアします。よろしいですか？\n(アップロードされたファイルは削除されません)"))return!1;this.setImage(null)},onVEInit:function(){this.item.veInited=!0},onDragover:function(t){if(!this.canDrop())return!1;t.dataTransfer.dropEffect="copy",this.dragover=!0},onDragleave:function(t){if(!this.canDrop())return!1;this.dragover=!1},onDrop:function(t){var e,i,o,n;return!!this.canDrop()&&((e=this).dragover=!1,this.isLoadingFile=!0,this.uploadProgress=0,t=t.dataTransfer.files,i="",0==(file_count=t.length)?i="画像が指定されていません":1<file_count&&(i="アップロードできる画像は1個までです"),t=t[0],!i&&t.size>O(u.options.maxFileSize)&&(i="画像のサイズが上限("+u.options.maxFileSize+")を超過しています"),o=u.options.imageTypes,!i&&o&&(n=new RegExp(".("+o.join("|")+")$"),t.name.match(n)||(i="画像の種類は "+o.join("・")+" のいずれかである必要があります")),i?(this.isLoadingFile=!1,alert(i),!1):void F.upload.call(this,t,u.options.uploaderPath,u.options.uploaderDir,function(t){e.isLoadingFile=!1,e.setImage(t)},function(t){e.isLoadingFile=!1,alert(t)},function(t){e.uploadProgress=100*t}))},onFocus:function(){this.focus=!0},onBlur:function(){this.focus=!1}}},f={template:'  <div class="item-wrap">    <div class="item link" v-bind:class="{dragover:dragover, dragging:dragging}" v-on:dragover.prevent.stop="onDragover" v-on:dragleave="onDragleave" v-on:drop.prevent.stop="onDrop">      <div class="loading" v-if="isLoadingFile"><div class="progress-wrap"><div class="progress" v-bind:style="{width: uploadProgress + \'%\'}"></div></div></div>      <div class="col1">        <label v-on:dragstart="onLabelDragstart" v-on:dragend="onLabelDragend" draggable="true">リンク</label>      </div>      <div class="col2">        <div class="class-wrap" v-if="isCssClassEnabled">          <label :for="item.id+\'_css\'">CSSクラス</label>          <input type="text" v-model="item.className" :id="item.id+\'_css\'" />        </div>        <div class="wrap">          <ul>            <li><label>URL</label><input type="text" placeholder="http://www.example.com/" class="url" v-model="item.url" v-on:keydown.enter.prevent="" /></li>            <li><label>テキスト</label><input type="text" placeholder="リンクに設定するテキストを入力" class="text" v-model="item.text" v-on:keydown.enter.prevent="" /></li>            <li class="link-target"><label><input type="checkbox" v-model="item.newWindow" />別ウィンドウで開く</label></li>          </ul>        </div>        <button class="uploader" tabindex="-1" v-on:click.prevent="onUploaderClick">アップロード済みのファイルから選択</button>      </div>      <div class="col3"><button v-on:click.prevent="onItemDelete" tabindex="-1"><span>削除</span></button></div>    </div>    <separator v-on:label-drop-on-separator="onLabelDrop" v-on:separator-click="onSeparatorClick" />  </div>',props:["item"],components:{separator:d},mixins:[n],data:function(){return{dragover:!1,isDndSupported:!u.options.uploaderDomain,isLoadingFile:!1,uploadProgress:0}},methods:{canDrop:function(){return this.isDndSupported&&!a},onUploaderClick:function(t){return F.showUploader(u.options.uploaderDomain,u.options.uploaderPath,u.options.uploaderDir,this.setFile),!1},setFile:function(t){var e=u.options.fileTypes;if(e){var i=new RegExp(".("+e.join("|")+")$");if(!t.match(i))return alert("ファイルの種類は "+e.join("・")+" のいずれかである必要があります"),!1}this.item.url=t},onDragover:function(t){if(!this.canDrop())return!1;t.dataTransfer.dropEffect="copy",this.dragover=!0},onDragleave:function(t){if(!this.canDrop())return!1;this.dragover=!1},onDrop:function(t){var e,i,o,n;return!!this.canDrop()&&((e=this).dragover=!1,this.isLoadingFile=!0,this.uploadProgress=0,t=t.dataTransfer.files,i="",0==(file_count=t.length)?i="ファイルが指定されていません":1<file_count&&(i="アップロードできるファイルは1個までです"),t=t[0],!i&&t.size>O(u.options.maxFileSize)&&(i="ファイルのサイズが上限("+u.options.maxFileSize+")を超過しています"),o=u.options.fileTypes,!i&&o&&(n=new RegExp(".("+o.join("|")+")$"),t.name.match(n)||(i="ファイルの種類は "+o.join("・")+" のいずれかである必要があります")),i?(this.isLoadingFile=!1,alert(i),!1):void F.upload(t,u.options.uploaderPath,u.options.uploaderDir,function(t){e.isLoadingFile=!1,e.setFile(t)},function(t){e.isLoadingFile=!1,alert(t)},function(t){e.uploadProgress=100*t}))}}},w={template:'  <div class="item-wrap">    <div class="item list" v-bind:class="{dragging:dragging}">      <div class="col1">        <label v-on:dragstart="onLabelDragstart" v-on:dragend="onLabelDragend" draggable="true">リスト</label>      </div>      <div class="col2">        <div class="class-wrap" v-if="isCssClassEnabled">          <label :for="item.id+\'_css\'">CSSクラス</label>          <input type="text" v-model="item.className" :id="item.id+\'_css\'" />        </div>        <div class="list-wrap">          <listSeparator v-bind:droppingRow="droppingRow" v-on:row-drop="onRowDrop" />          <transition-group name="list-row" tag="div">          <row v-for="(row, index) in item.rows" v-bind:row=row v-bind:droppingRow="droppingRow" :key="row.id" v-on:row-delete="deleteRow" v-on:row-dragstart="onRowDragstart" v-on:row-dragend="onRowDragend" v-on:row-drop="onRowDrop" />          </transition-group>        </div>        <div class="ctl">          <button class="add" tabindex="-1" v-on:click.prevent="addRow">行の追加</button>        </div>      </div>      <div class="col3"><button v-on:click.prevent="onItemDelete" tabindex="-1"><span>削除</span></button></div>    </div>    <separator v-on:label-drop-on-separator="onLabelDrop" v-on:separator-click="onSeparatorClick" />  </div>',props:["item"],components:{row:{template:'  <div class="list-row-wrap">    <div class="row" v-bind:class="{dragging:dragging, focus:focus}" v-bind:draggable="draggable" v-on:dragstart="onRowDragstart" v-on:dragend="onRowDragend">      <label v-on:mouseover="onLabelMouseover" v-on:mouseout="onLabelMouseout"></label>      <input type="text" v-model="row.text" v-on:focus="onFocus" v-on:blur="onBlur" v-on:keydown.enter.prevent="" />      <button class="del" tabindex="-1" v-on:click.prevent="onRowDelete"></button>    </div>    <listSeparator v-bind:droppingRow="droppingRow" v-on:row-drop="onRowDrop" />  </div>',props:["row","droppingRow"],components:{listSeparator:E={template:'    <div class="list-separator" v-bind:class="{dragover:dragover}" v-on:dragover.prevent.stop="onDragover" v-on:dragleave="onDragleave" v-on:drop.prevent.stop="onDrop"></div>',props:["droppingRow"],data:function(){return{dragover:!1}},methods:{canDrop:function(){return!!this.droppingRow},onDragover:function(t){if(!this.canDrop())return!1;this.dragover=!0,t.dataTransfer.dropEffect="move"},onDragleave:function(t){if(!this.canDrop())return!1;this.dragover=!1},onDrop:function(t){if(!this.canDrop())return!1;this.dragover=!1,this.$emit("row-drop")}}}},data:function(){return{dragging:!1,draggable:!1,focus:!1}},methods:{onRowDelete:function(){this.$emit("row-delete",this.row)},onLabelMouseover:function(){this.draggable=!0},onLabelMouseout:function(){this.draggable=!1},onRowDragstart:function(t){t.dataTransfer.setData("text","element"),t.dataTransfer.effectAllowed="move",this.dragging=!0,this.$emit("row-dragstart",this.row)},onRowDragend:function(t){this.dragging=!1,this.$emit("row-dragend",this.row)},onRowDrop:function(t){this.dragging=!1,this.$emit("row-drop",this.row)},onFocus:function(){this.focus=!0},onBlur:function(){this.focus=!1}}},separator:d,listSeparator:E},data:function(){return{droppingRow:null}},mixins:[n],methods:{addRow:function(){var t=P();console.log(t),this.item.rows.push({component:"row",text:null,id:t}),console.log(this.item.rows)},deleteRow:function(t){return!(t.text&&!confirm("行を削除します。よろしいですか？"))&&-1!==(t=this.item.rows.indexOf(t))&&void(this.item.rows.length<=1?this.item.rows[0].text=null:this.item.rows.splice(t,1))},onRowDragstart:function(t){this.droppingRow=t},onRowDragend:function(t){this.droppingRow=null},onRowDrop:function(t){var e,i;return!!this.droppingRow&&(i=t?this.item.rows.indexOf(t)+1:0,e=this.item.rows.indexOf(this.droppingRow),this.droppingRow=null,i!==e)&&i!==e+1&&(e=this.item.rows.splice(e,1),i=t?this.item.rows.indexOf(t)+1:0,void this.item.rows.splice(i,0,e[0]))}}},b={template:'    <div class="table-menu" v-bind:class="[data.direction,{show: data.show}]" ref="tableMenu">      <ul>        <li v-bind:class="{show: data.mode==\'col\'}" v-on:click="onMenuClick" data-action="insert-left">左に列を挿入</li>        <li v-bind:class="{show: data.mode==\'col\'}" v-on:click="onMenuClick" data-action="insert-right">右に列を挿入</li>        <li v-bind:class="{show: data.mode==\'row\'}" v-on:click="onMenuClick" data-action="insert-above">上に行を挿入</li>        <li v-bind:class="{show: data.mode==\'row\'}" v-on:click="onMenuClick" data-action="insert-below">下に行を挿入</li>        <li v-bind:class="{show: data.mode==\'row\'}" v-on:click="onMenuClick" data-action="header-row">行を見出しにする</li>        <li v-bind:class="{show: data.mode==\'col\'}" v-on:click="onMenuClick" data-action="header-col">列を見出しにする</li>        <li v-bind:class="{show: data.mode==\'row\'}" v-on:click="onMenuClick" data-action="de-header-row">行の見出しを解除</li>        <li v-bind:class="{show: data.mode==\'col\'}" v-on:click="onMenuClick" data-action="de-header-col">列の見出しを解除</li>        <li v-bind:class="{show: data.mode==\'row\'}" v-on:click="onMenuClick" data-action="delete-row">行を削除</li>        <li v-bind:class="{show: data.mode==\'col\'}" v-on:click="onMenuClick" data-action="delete-col">列を削除</li>      </ul>    </div>',props:["data"],methods:{onMenuClick:function(t){t=$(t.target).attr("data-action");this.$emit("menu-click",t)}}},x={template:'  <div class="item-wrap">    <div class="item table" v-bind:class="">      <div class="col1">        <label v-on:dragstart="onLabelDragstart" v-on:dragend="onLabelDragend" draggable="true">表組み</label>      </div>      <div class="col2">        <div class="class-wrap" v-if="isCssClassEnabled">          <label :for="item.id+\'_css\'">CSSクラス</label>          <input type="text" v-model="item.className" :id="item.id+\'_css\'" />        </div>        <div class="size">          <label>横</label><input v-model="colNumInput" type="text"> × <label>縦</label><input v-model="rowNumInput" type="text"><button tabindex="-1" class="apply" v-on:click.prevent="applyChange">適用</button>        </div>        <div class="table-wrap">          <table ref="table">            <thead>              <tr>                <th></th>                <colHeader                   v-for="col in colNum"                  v-bind:colNo=col                  :key="col"                  v-on:menu-click="onColMenuClick"                  v-on:col-dragstart="onColDragstart"                  v-on:col-dragend="onColDragend"                  v-on:col-dragover="onColDragover">              </tr>            </thead>            <tbody>              <row                 v-for="(row, index) in item.rows"                v-bind:row=row :key="row"                v-on:editstart="onEditStart"                v-on:dragover.prevent.stop="onDragover"                v-on:row-menu-click="onRowMenuClick"                v-on:row-dragstart="onRowDragstart"                v-on:row-dragend="onRowDragend"                v-on:row-dragover="onRowDragover"                 />            </tbody>          </table>          <div class="col-button-wrap"><button class="add add-col" v-on:click.prevent="addCol()" v-bind:disabled="isMaxCol">列</button></div>          <div class="line-selection" ref="lineSelection"></div>          <div class="insert-line" ref="insertLine"></div>          <div class="dragging-selection" ref="draggingSelection"></div>        </div>        <button class="add add-row" v-on:click.prevent="addRow()" v-bind:disabled="isMaxRow">行</button>      </div>      <div class="col3"><button v-on:click.prevent="onItemDelete" tabindex="-1"><span>削除</span></button></div>    </div>    <component      class="table-ve"      v-bind:is="inputComponent"      v-bind:isPlaceholderEnabled=false      v-bind:text=item.text      v-on:input="onTextChange"      v-on:ve-init="onVEInit"      ref="celleditor" />    <div class="ve-overlay" v-on:click="onEditEnd" ref="veOverlay"></div>    <separator v-on:label-drop-on-separator="onLabelDrop" v-on:separator-click="onSeparatorClick" />  </div>',props:["item"],components:{row:{template:'  <tr     v-bind:draggable="draggable"    v-on:dragstart="onDragstart"    v-on:dragover="onDragover"    v-on:dragend="onDragend">    <th       v-bind:class="{dragging:dragging}"      v-on:mouseover="onMouseover"      v-on:mouseout="onMouseout"><div class="menu row-menu" v-on:click.prevent.stop="onMenuClick"></div></th>    <column      v-for="(col, index) in row.cols"      v-bind:col=col      v-on:editstart="onEditStart"      :key="col" />  </tr>',props:["row","droppingRow"],components:{listSeparator:E,column:{template:'  <td     class="ve-style"    v-bind:class="{header: col.header}"    v-on:click="onClick"    ref="inputElement"></td>  ',props:["col"],mounted:function(){var t=$(this.$refs.inputElement);this.col.text?t.html(this.col.text):t.html("<br>")},watch:{"col.text":function(t){$(this.$refs.inputElement).html(t)}},methods:{onClick:function(){this.$emit("editstart",this.col)}}}},data:function(){return{dragging:!1,draggable:!1}},methods:{onEditStart:function(t){this.$emit("editstart",this.row,t)},onMenuClick:function(t){this.$emit("row-menu-click",this.row,t)},onMouseover:function(){this.draggable=!0},onMouseout:function(){this.draggable=!1},onDragstart:function(t){var e;t.dataTransfer.setData("text","element"),t.dataTransfer.effectAllowed="move",t.dataTransfer.setDragImage&&((e=new Image).src=H+"img/blank.png",t.dataTransfer.setDragImage(e,0,0)),this.dragging=!0,this.$emit("row-dragstart",this.row,t)},onDragover:function(t){this.$emit("row-dragover",t)},onDragend:function(t){this.dragging=!1,this.$emit("row-dragend",this.row,t)}}},colHeader:{props:["colNo"],data:function(){return{dragging:!1,draggable:!1}},template:'    <th      v-bind:draggable="draggable"      v-bind:class="{dragging:dragging}"      v-on:dragstart="onDragstart"      v-on:dragover="onDragover"      v-on:dragend="onDragend"      v-on:mouseover="onMouseover"      v-on:mouseout="onMouseout">      <div         class="menu col-menu"        v-on:click.prevent.stop="onMenuClick(colNo-1,$event)"></div>    </th>',methods:{onMenuClick:function(t,e){this.$emit("menu-click",t,e)},onMouseover:function(){this.draggable=!0},onMouseout:function(){this.draggable=!1},onDragstart:function(t){var e;t.dataTransfer.setData("text","element"),t.dataTransfer.effectAllowed="move",t.dataTransfer.setDragImage&&((e=new Image).src=H+"img/blank.png",t.dataTransfer.setDragImage(e,0,0)),this.dragging=!0,this.$emit("col-dragstart",this.colNo-1,t)},onDragend:function(t){this.dragging=!1,this.$emit("col-dragend",this.colNo-1,t)},onDragover:function(t){this.$emit("col-dragover",t)}}},visualeditor:m,plaintexteditor:M,separator:d},data:function(){return{inputComponent:u.options.inlineVe?"visualeditor":"plaintexteditor",prevDraggingTime:0,colNumInput:u.options.tableDefaultColNum,rowNumInput:1,actionPos:0,isDraggingRow:!1,isDraggingCol:!1,dropRowPos:-1,dropColPos:-1,editingCol:null}},created:function(){this.item.rows&&0!=this.item.rows.length||this.addRow(),this.syncInput(),(new Image).src=H+"img/blank.png"},mounted:function(){$(this.$refs.celleditor.$el).hide(),$(this.$el).on("click","a",function(t){t.stopPropagation(),t.preventDefault()})},mixins:[n],computed:{rowNum:function(){return this.item.rows?this.item.rows.length:0},colNum:function(){return this.item.rows&&0!=this.item.rows.length?this.item.rows[0].cols.length:0},isMaxRow:function(){return this.rowNum>=u.options.tableMaxRow},isMaxCol:function(){return this.colNum>=u.options.tableMaxCol}},methods:{applyChange:function(){if(this.rowNumInput=parseInt(String(this.rowNumInput).replace(/[０-９]/g,function(t){return String.fromCharCode(t.charCodeAt(0)-65248)})),this.colNumInput=parseInt(String(this.colNumInput).replace(/[０-９]/g,function(t){return String.fromCharCode(t.charCodeAt(0)-65248)})),this.rowNumInput<=0||this.rowNumInput>u.options.tableMaxRow)return alert("テーブルの行数は 1〜"+u.options.tableMaxRow+" の範囲で設定可能です"),!1;if(this.colNumInput<=0||this.colNumInput>u.options.tableMaxCol)return alert("テーブルの列数は 1〜"+u.options.tableMaxCol+" の範囲で設定可能です"),!1;if(this.rowNumInput||(this.rowNumInput=1),this.colNumInput||(this.colNumInput=u.options.tableDefaultColNum),(this.rowNum>this.rowNumInput||this.colNum>this.colNumInput)&&!confirm("現在の入力エリアよりも縮小するため、データが失われます。よろしいですか？"))return!1;if(this.rowNumInput>this.rowNum)for(var t=this.rowNumInput-this.rowNum,e=0;e<t;e++)this.addRow(null);else if(this.rowNumInput<this.rowNum)for(t=this.rowNum-this.rowNumInput,e=0;e<t;e++)this.deleteRow(null);if(this.colNumInput>this.colNum)for(t=this.colNumInput-this.colNum,e=0;e<t;e++)this.addCol(null);else if(this.colNumInput<this.colNum)for(t=this.colNum-this.colNumInput,e=0;e<t;e++)this.deleteCol(null)},onTextChange:function(t){},onVEInit:function(){},onEditStart:function(t,e){var i=$(this.$refs.celleditor.$el),o=$(this.$refs.veOverlay),n=$(this.$refs.table),a=$(u.vue.$el),t=this.rowIndex(t),s=this.colIndex(e);if(t<0||s<0)return!1;var n=n.find("tbody tr").eq(t),t=n.find("td").eq(s),s=t.width(),l=t.outerHeight()-2,t=t.offset().left-a.offset().left,n=n.offset().top-a.offset().top;l<80&&(l=80),i.width(s).css({left:t+"px",top:n+"px",minHeight:l+"px"}).html(e.text).show(),setTimeout(function(){i.trigger("focus")},0),o.show(),a.append(o).append(i),this.editingCol=e},onEditEnd:function(t){if(!this.editingCol)return!1;var e=$(this.$refs.celleditor.$el),i=$(this.$refs.veOverlay),o=$(this.$el);this.editingCol.text=e.html(),e.trigger("blur").hide(),i.hide(),o.append(e).append(i),this.editingCol=null},onRowMenuClick:function(t,e){for(var i=null,o=0;o<this.rowNum;o++)t==this.item.rows[o]&&(i=o,this.onMenuClick(i,"row",e));null!=i&&this.showLineSelection("row",i)},onColMenuClick:function(t,e){this.onMenuClick(t,"col",e),this.showLineSelection("col",t)},onMenuClick:function(t,e,i){this.actionPos=t,this.$emit("table-header-menu-click",this,e,i)},doAction:function(t){switch(t){case"insert-left":this.addCol(this.actionPos);break;case"insert-right":this.addCol(this.actionPos+1);break;case"insert-above":this.addRow(this.actionPos);break;case"insert-below":this.addRow(this.actionPos+1);break;case"delete-row":confirm("行を削除します。よろしいですか?")&&this.deleteRow(this.actionPos);break;case"delete-col":confirm("列を削除します。よろしいですか?")&&this.deleteCol(this.actionPos);break;case"header-row":this.headerRow(this.actionPos,!0);break;case"header-col":this.headerCol(this.actionPos,!0);break;case"de-header-row":this.headerRow(this.actionPos,!1);break;case"de-header-col":this.headerCol(this.actionPos,!1)}this.showLineSelection()},addRow:function(t){if(this.item.rows.length>=u.options.tableMaxRow)return!1;null==t&&(t=this.rowNum);for(var e=[],i=this.colNum||u.options.tableDefaultColNum,o=0;o<i;o++)e.push({text:"",header:this.isHeaderCol(o)});this.item.rows||(this.item.rows=[]),this.item.rows.splice(t,0,{cols:e}),this.syncInput("row")},addCol:function(t){if(this.item.rows&&this.item.rows[0].cols.length>=u.options.tableMaxCol)return!1;null==t&&(t=this.colNum);for(var e=this.item.rows.length,i=[],o=0;o<e;o++)i[o]=this.isHeaderRow(o);for(o=0;o<e;o++)this.item.rows[o].cols.splice(t,0,{text:"",header:i[o]});this.syncInput("col")},deleteRow:function(t){null==t&&(t=this.rowNum-1),this.item.rows.splice(t,1),0==this.rowNum&&this.addRow(null),this.syncInput("row")},deleteCol:function(t){null==t&&(t=this.colNum-1);for(var e=0;e<this.rowNum;e++)this.item.rows[e].cols.splice(t,1);0==this.colNum&&this.addCol(null),this.syncInput("col")},headerRow:function(t,e){for(var i=0;i<this.colNum;i++)this.item.rows[t].cols[i].header=e},headerCol:function(t,e){for(var i=0;i<this.rowNum;i++)this.item.rows[i].cols[t].header=e},isHeaderRow:function(t){for(var e=0,i=0;i<this.colNum;i++)this.item.rows[t].cols[i].header&&e++;return 0<this.colNum&&this.colNum==e},isHeaderCol:function(t){for(var e=0,i=0;i<this.rowNum;i++)this.item.rows[i].cols[t].header&&e++;return 0<this.rowNum&&this.rowNum==e},syncInput:function(t){"row"==t?this.rowNumInput=this.rowNum:"col"==t?this.colNumInput=this.colNum:(this.colNumInput=this.colNum,this.rowNumInput=this.rowNum)},showLineSelection:function(t,e){var i,o,n,a=$(this.$refs.lineSelection),s=$(this.$refs.table);void 0===t?a.hide():"row"==t?(i=s.find("tr").eq(e+1),o=s.position().left+i.position().left,n=s.position().top+i.position().top,a.show().width(i.outerWidth()-1).height(i.outerHeight()-1).css({left:o+"px",top:n+"px"})):"col"==t&&(i=s.find("tr").eq(0).find("th").eq(e+1),o=s.position().left+i.position().left,n=s.position().top,a.show().width(i.outerWidth()-1).height(s.outerHeight()-2).css({left:o+"px",top:n+"px"}))},onRowDragstart:function(t,e){var i=$(this.$refs.insertLine),o=$(this.$refs.draggingSelection),n=$(this.$refs.table);$(this.$el);if(i.show().width(n.width()).height("2px").css({left:n.position().left+"px"}),e.dataTransfer.setDragImage){for(var a=-1,s=0;s<this.rowNum;s++)if(this.item.rows[s]==t){a=s;break}var i=n.find("tbody tr").eq(a).outerHeight(),l=n.position().left+n.find("thead tr th").eq(0).outerWidth();o.show().width(n.width()-n.find("thead tr th").eq(0).outerWidth()).height(i).css({left:l+"px"})}this.isDraggingRow=!0,this.onRowDragover(e)},onRowDragover:function(t){var e,i,o,n,a;!this.isDraggingRow||(e=(new Date).getTime())-this.prevDraggingTime<20||(this.prevDraggingTime=e,e=$(this.$refs.insertLine),i=$(this.$refs.table),o=$(this.$refs.draggingSelection),a=(n=this.draggingRowPosition(t))>=this.rowNum?i.position().top+i.find("tbody tr").eq(n-1).offset().top-i.offset().top+i.find("tbody tr").eq(n-1).outerHeight():i.position().top+i.find("tbody tr").eq(n).offset().top-i.offset().top,e.css({top:a+"px"}),a=i.position().top+t.pageY-i.offset().top-o.height()/2,o.css({top:a+"px"}),this.dropRowPos=n)},onRowDragend:function(t,e){$(this.$refs.insertLine).hide();$(this.$refs.draggingSelection).hide();for(var i=this.dropRowPos,o=-1,n=0;n<this.rowNum;n++)if(this.item.rows[n]==t){o=n;break}-1!=o&&o!=i&&(this.item.rows.splice(o,1),o<i&&i--,this.item.rows.splice(i,null,t),this.isDraggingRow=!1)},draggingRowPosition:function(o){var n=this,t=$(this.$refs.table),a=-1;return $first_row=t.find("tbody tr").eq(0),$last_row=t.find("tbody tr").eq(this.rowNum-1),t.find("tbody tr").each(function(t){var e=$(this),i=e.offset().top,e=e.outerHeight();i<o.pageY&&o.pageY<i+e?(i+e/2>=o.pageY&&(a=t),i+e/2<o.pageY&&(a=t+1)):o.pageY<=$first_row.offset().top?a=0:o.pageY>=$last_row.offset().top+$last_row.outerHeight()&&(a=n.rowNum)}),a},onColDragstart:function(t,e){var i=$(this.$refs.insertLine),o=$(this.$refs.draggingSelection),n=$(this.$refs.table);i.show().height(n.height()).width(2).css({top:n.position().top+"px"}),e.dataTransfer.setDragImage&&(i=n.find("thead tr th").eq(t+1).outerWidth(),t=n.outerHeight()-n.find("thead tr").eq(0).outerHeight()-2,n=n.position().top+n.find("thead tr th").eq(0).outerHeight(),o.show().width(i).height(t).css({top:n+"px"})),this.isDraggingCol=!0,this.onColDragover(e)},onColDragover:function(t){var e,i,o,n,a;!this.isDraggingCol||(e=(new Date).getTime())-this.prevDraggingTime<20||(this.prevDraggingTime=e,e=$(this.$refs.insertLine),i=$(this.$refs.table),o=$(this.$refs.draggingSelection),a=(n=this.draggingColPosition(t))>=this.colNum?i.position().left+i.find("thead tr th").eq(this.colNum).position().left+i.find("thead tr th").eq(this.colNum-1).outerWidth():i.position().left+i.find("thead tr th").eq(n+1).offset().left-i.offset().left,e.css({left:a+"px"}),a=i.position().left+t.pageX-i.offset().left-o.width()/2,o.css({left:a+"px"}),this.dropColPos=n)},onColDragend:function(t,e){$(this.$refs.insertLine).hide();$(this.$refs.draggingSelection).hide();var i=this.dropColPos,o=t;if(V({src_pos:o,dest_pos:i}),-1!=o&&o!=i){o<i&&i--;for(var n=0;n<this.rowNum;n++){var a=this.item.rows[n].cols,s=a.splice(o,1);a.splice(i,null,s[0])}this.isDraggingCol=!1}},draggingColPosition:function(o){var n=this,t=$(this.$refs.table),a=-1;return $first_col=t.find("thead tr th").eq(1),$last_col=t.find("thead tr th").eq(this.colNum),t.find("thead th").each(function(t){var e=$(this),i=e.offset().left,e=e.outerWidth();i<o.pageX&&o.pageX<i+e?i+e/2>=o.pageX?a=t:i+e/2<o.pageX&&(a=t+1):o.pageX<=$first_col.offset().left?a=1:o.pageX>=$last_col.offset().left+$last_col.outerWidth()&&(a=n.colNum+1)}),0<a&&a--,a},rowIndex:function(t){if(0!=this.rowNum)for(var e=0;e<this.rowNum;e++)if(this.item.rows[e]==t)return e;return-1},colIndex:function(t){if(0!=this.rowNum)for(var e=0;e<this.rowNum;e++)for(var i=this.item.rows[e],o=0;o<this.colNum;o++)if(i.cols[o]==t)return o;return-1}}},D={template:'  <div class="item-wrap">    <div class="item html" v-bind:class="[item.type, {dragging:dragging}]">      <div class="col1">        <label v-on:dragstart="onLabelDragstart" v-on:dragend="onLabelDragend" draggable="true">HTML</label>      </div>      <div class="col2">        <div class="class-wrap" v-if="isCssClassEnabled">          <label :for="item.id+\'_css\'">CSSクラス</label>          <input type="text" v-model="item.className" :id="item.id+\'_css\'" />        </div>        <textarea v-model="item.html" v-on:input="onInput" ref="inputElement" />      </div>      <div class="col3"><button v-on:click.prevent="onItemDelete" tabindex="-1"><span>削除</span></button></div>    </div>    <separator v-on:label-drop-on-separator="onLabelDrop" v-on:separator-click="onSeparatorClick" />  </div>',props:["item"],components:{separator:d},mixins:[n],mounted:function(){var t,e=this.$refs.inputElement;document.createEvent?((t=document.createEvent("HTMLEvents")).initEvent("input",!0,!0),e.dispatchEvent(t)):(t=document.createEventObject(),e.fireEvent("oninput",t))},computed:{labelName:function(){return u.options.typeNames[this.item.type]}},methods:{onInput:function(t){var e,i=window.getComputedStyle(t.target),o=i.lineHeight.split("px")[0];i.paddingTop.split("px")[0],i.paddingBottom.split("px")[0];if(t.target.scrollHeight>t.target.offsetHeight)t.target.style.height=t.target.scrollHeight+3+"px";else for(;;){if(e=t.target.style.height.split("px")[0],t.target.style.height=e-o+"px",t.target.scrollHeight>t.target.offsetHeight){t.target.style.height=t.target.scrollHeight+3+"px";break}break}}}},k={template:'  <div class="item-wrap">    <div class="item link" >      <div class="loading" v-if="isLoadingFile"><div class="progress-wrap"><div class="progress" v-bind:style="{width: uploadProgress + \'%\'}"></div></div></div>      <div class="col1">        <label v-on:dragstart="onLabelDragstart" v-on:dragend="onLabelDragend" draggable="true">リンク</label>      </div>      <div class="col2">        <div class="class-wrap" v-if="isCssClassEnabled">          <label :for="item.id+\'_css\'">CSSクラス</label>          <input type="text" v-model="item.className" :id="item.id+\'_css\'" />        </div>        <div class="wrap">          <ul>            <li><label>URL</label><input type="text" placeholder="http://www.example.com/" class="url" v-model="item.links[0].url" v-on:keydown.enter.prevent="" /></li>            <li><label>テキスト</label><input type="text" placeholder="リンクに設定するテキストを入力" class="text" v-model="item.links[0].text" v-on:keydown.enter.prevent="" /></li>            <li class="link-target"><label><input type="checkbox" v-model="item.links[0].newWindow" />別ウィンドウで開く</label></li>          </ul>          <button class="uploader" tabindex="-1" v-on:click.prevent="onUploaderClick(0)">アップロード済みのファイルから選択</button>        </div>        <div class="wrap">          <ul>            <li><label>URL</label><input type="text" placeholder="http://www.example.com/" class="url" v-model="item.links[1].url" v-on:keydown.enter.prevent="" /></li>            <li><label>テキスト</label><input type="text" placeholder="リンクに設定するテキストを入力" class="text" v-model="item.links[1].text" v-on:keydown.enter.prevent="" /></li>            <li class="link-target"><label><input type="checkbox" v-model="item.links[1].newWindow" />別ウィンドウで開く</label></li>          </ul>          <button class="uploader" tabindex="-1" v-on:click.prevent="onUploaderClick(1)">アップロード済みのファイルから選択</button>        </div>      </div>      <div class="col3"><button v-on:click.prevent="onItemDelete" tabindex="-1"><span>削除</span></button></div>    </div>    <separator v-on:label-drop-on-separator="onLabelDrop" v-on:separator-click="onSeparatorClick" />  </div>',props:["item"],components:{separator:d},mixins:[n],data:function(){return{dragover:!1,isDndSupported:!u.options.uploaderDomain,isLoadingFile:!1,uploadProgress:0}},methods:{canDrop:function(){return this.isDndSupported&&!a},onUploaderClick:function(t){var o=t,n=this;return F.showUploader(u.options.uploaderDomain,u.options.uploaderPath,u.options.uploaderDir,function(t){var e=u.options.fileTypes;if(e){var i=new RegExp(".("+e.join("|")+")$");if(!t.match(i))return alert("ファイルの種類は "+e.join("・")+" のいずれかである必要があります"),!1}n.item.links[o].url=t}),!1}}},C={template:'  <div class="item-wrap">    <div class="item image" v-bind:class="{\'ve-unload\': !item.veInited, nofile: !item.image, dragover:dragover, dragging:dragging}" v-on:dragover.prevent.stop="onDragover" v-on:dragleave="onDragleave" v-on:drop.prevent.stop="onDrop">      <div class="loading" v-if="isLoadingFile"><div class="progress-wrap"><div class="progress" v-bind:style="{width: uploadProgress + \'%\'}"></div></div></div>      <div class="col1">        <label v-on:dragstart="onLabelDragstart" v-on:dragend="onLabelDragend" draggable="true">画像</label>      </div>      <div class="col2">        <div class="class-wrap" v-if="isCssClassEnabled">          <label :for="item.id+\'_css\'">CSSクラス</label>          <input type="text" v-model="item.className" :id="item.id+\'_css\'" />        </div>        <div class="dnd" v-if="isDndSupported" v-on:dblclick="selectFile">          <div class="msg">画像をドラッグ＆ドロップ</div>        </div>        <div class="content" style="border:none">          <div class="img" v-bind:class="item.align" style="margin:0px;padding-right:20px;box-sizing:border-box;">            <img v-bind:src="item.image" v-on:dblclick="selectFile" draggable="false" style="margin-right:10px;display:block;" />          </div>          <div class="img left" style="margin:0px;width:100%;">            <label>見出し</label>            <input type="text" v-model="item.heading" ref="inputElement" style="margin-bottom:10px" @keydown.enter.prevent="handleEnterKey"/>            <label>テキスト</label>            <component              v-bind:is="inputComponent"              v-bind:isPlaceholderEnabled=true              class="text"              v-bind:class="{focus:focus}"              style="border: 1px solid #aaa; padding:8px 5px; min-height:9em;"              v-bind:text=item.text              v-on:input="onTextChange"              v-on:ve-init="onVEInit"              v-on:focus="onFocus"              v-on:blur="onBlur" />              <div class="wrap" style="margin-top:10px">                <ul>                  <li><label>リンク(URL)</label><input type="text" placeholder="http://www.example.com/" class="url" v-model="item.link_url" v-on:keydown.enter.prevent="" style="margin-top:3px" /></li>                  <li style="margin-top:10px"><label>リンク(テキスト)</label><input type="text" placeholder="リンクに設定するテキストを入力" class="text" v-model="item.link_text" v-on:keydown.enter.prevent="" style="margin-top:3px; min-height:1em;" /></li>                </ul>              </div>          </div>        </div>        <div class="alt-wrap" v-if="isAltEnabled">          <label :for="item.id+\'_alt\'">ALT</label>          <input type="text" v-model="item.altName" :id="item.id+\'_alt\'" />        </div>        <button class="remove" tabindex="-1" v-on:click.prevent="onFileDelete">画像をクリア</button>        <button class="uploader" tabindex="-1" v-on:click.prevent="selectFile">アップロード済みの画像から選択</button>      </div>      <div class="col3"><button v-on:click.prevent="onItemDelete" tabindex="-1"><span>削除</span></button></div>    </div>    <separator v-on:label-drop-on-separator="onLabelDrop" v-on:separator-click="onSeparatorClick" />  </div>',props:["item"],data:function(){return{randomID:[],dragover:!1,isDndSupported:!u.options.uploaderDomain,isLoadingFile:!1,uploadProgress:0,inputComponent:u.options.inlineVe?"visualeditor":"plaintexteditor",focus:!1}},components:{visualeditor:m,plaintexteditor:M,separator:d},mixins:[n],created:function(){},mounted:function(){for(var t=0;t<3;t++)this.randomID.push("image-align-"+P(6,"numeric"))},computed:{isAltEnabled:function(){return u.options.allowImageAlt}},methods:{canDrop:function(){return this.isDndSupported&&!a},handleEnterKey(){return!0},selectFile:function(t){return F.showUploader(u.options.uploaderDomain,u.options.uploaderPath,u.options.uploaderDir,this.setImage),!1},onTextChange:function(t){this.item.text=t},setImage:function(t){var e=u.options.imageTypes;if(t&&e){var i=new RegExp(".("+e.join("|")+")$");if(!t.match(i))return alert("画像の種類は "+e.join("・")+" のいずれかである必要があります"),!1}this.item.image=t},onFileDelete:function(){if(!confirm("画像をクリアします。よろしいですか？\n(アップロードされたファイルは削除されません)"))return!1;this.setImage(null)},onVEInit:function(){this.item.veInited=!0},onDragover:function(t){if(!this.canDrop())return!1;t.dataTransfer.dropEffect="copy",this.dragover=!0},onDragleave:function(t){if(!this.canDrop())return!1;this.dragover=!1},onDrop:function(t){var e,i,o,n;return!!this.canDrop()&&((e=this).dragover=!1,this.isLoadingFile=!0,this.uploadProgress=0,t=t.dataTransfer.files,i="",0==(file_count=t.length)?i="画像が指定されていません":1<file_count&&(i="アップロードできる画像は1個までです"),t=t[0],!i&&t.size>O(u.options.maxFileSize)&&(i="画像のサイズが上限("+u.options.maxFileSize+")を超過しています"),o=u.options.imageTypes,!i&&o&&(n=new RegExp(".("+o.join("|")+")$"),t.name.match(n)||(i="画像の種類は "+o.join("・")+" のいずれかである必要があります")),i?(this.isLoadingFile=!1,alert(i),!1):void F.upload.call(this,t,u.options.uploaderPath,u.options.uploaderDir,function(t){e.isLoadingFile=!1,e.setImage(t)},function(t){e.isLoadingFile=!1,alert(t)},function(t){e.uploadProgress=100*t}))},onFocus:function(){this.focus=!0},onBlur:function(){this.focus=!1}}},y={template:'  <div class="item-wrap">    <div class="item list" v-bind:class="{dragging:dragging}">      <div class="col1">        <label v-on:dragstart="onLabelDragstart" v-on:dragend="onLabelDragend" draggable="true">リスト</label>      </div>      <div class="col2">        <div class="class-wrap" v-if="isCssClassEnabled">          <label :for="item.id+\'_css\'">CSSクラス</label>          <input type="text" v-model="item.className" :id="item.id+\'_css\'" />        </div>        <div class="list-wrap">          <listSeparator v-bind:droppingRow="droppingRow" v-on:row-drop="onRowDrop" />          <transition-group name="list-row" tag="div">          <row v-for="(row, index) in item.rows" :isLink=item.isLink v-bind:row=row v-bind:droppingRow="droppingRow" :key="row.id" v-on:row-delete="deleteRow" v-on:row-dragstart="onRowDragstart" v-on:row-dragend="onRowDragend" v-on:row-drop="onRowDrop" />          </transition-group>        </div>        <div class="ctl">          <button class="add" tabindex="-1" v-on:click.prevent="addRow">行の追加</button>        </div>      </div>      <div class="col3"><button v-on:click.prevent="onItemDelete" tabindex="-1"><span>削除</span></button></div>    </div>    <separator v-on:label-drop-on-separator="onLabelDrop" v-on:separator-click="onSeparatorClick" />  </div>',props:["item"],components:{row:{template:'  <div class="list-row-wrap">    <div class="row" v-bind:class="{dragging:dragging, focus:focus}" v-bind:draggable="draggable" v-on:dragstart="onRowDragstart" v-on:dragend="onRowDragend">      <label v-on:mouseover="onLabelMouseover" v-on:mouseout="onLabelMouseout"></label>      <input type="text" v-model="row.text" v-on:focus="onFocus" v-on:blur="onBlur" v-on:keydown.enter.prevent="" placeholder="テキストを入力してください" v-if="!isLink"/>      <input type="text" v-model="row.text" v-on:focus="onFocus" v-on:blur="onBlur" v-on:keydown.enter.prevent="" style="width:48%" placeholder="テキストを入力してください" v-if="isLink"/>      <input type="text" v-model="row.url" v-on:focus="onFocus" v-on:blur="onBlur" v-on:keydown.enter.prevent="" style="width:47%;padding-left:6px"  placeholder="URLを入力してください" v-if="isLink"/>      <button class="del" tabindex="-1" v-on:click.prevent="onRowDelete" style="margin-left: 0.5rem;"></button>    </div>    <listSeparator v-bind:droppingRow="droppingRow" v-on:row-drop="onRowDrop" />  </div>',props:["row","droppingRow","isLink"],components:{listSeparator:E},data:function(){return{dragging:!1,draggable:!1,focus:!1}},methods:{onRowDelete:function(){this.$emit("row-delete",this.row)},onLabelMouseover:function(){this.draggable=!0},onLabelMouseout:function(){this.draggable=!1},onRowDragstart:function(t){t.dataTransfer.setData("text","element"),t.dataTransfer.effectAllowed="move",this.dragging=!0,this.$emit("row-dragstart",this.row)},onRowDragend:function(t){this.dragging=!1,this.$emit("row-dragend",this.row)},onRowDrop:function(t){this.dragging=!1,this.$emit("row-drop",this.row)},onFocus:function(){this.focus=!0},onBlur:function(){this.focus=!1}}},separator:d,listSeparator:E},data:function(){return{droppingRow:null}},mixins:[n],methods:{addRow:function(){var t=P();console.log(t),this.item.rows.push({component:"row",text:null,id:t}),console.log(this.item.rows)},deleteRow:function(t){return!(t.text&&!confirm("行を削除します。よろしいですか？"))&&-1!==(t=this.item.rows.indexOf(t))&&void(this.item.rows.length<=1?this.item.rows[0].text=null:this.item.rows.splice(t,1))},onRowDragstart:function(t){this.droppingRow=t},onRowDragend:function(t){this.droppingRow=null},onRowDrop:function(t){var e,i;return!!this.droppingRow&&(i=t?this.item.rows.indexOf(t)+1:0,e=this.item.rows.indexOf(this.droppingRow),this.droppingRow=null,i!==e)&&i!==e+1&&(e=this.item.rows.splice(e,1),i=t?this.item.rows.indexOf(t)+1:0,void this.item.rows.splice(i,0,e[0]))}}},I={template:'  <div class="item-wrap">    <div class="item list" v-bind:class="{dragging:dragging}">      <div class="col1">        <label v-on:dragstart="onLabelDragstart" v-on:dragend="onLabelDragend" draggable="true">リンク</label>      </div>      <div class="col2">        <div class="list-wrap">          <listSeparator v-bind:droppingRow="droppingRow" v-on:row-drop="onRowDrop" />          <transition-group name="list-row" tag="div">          <row v-for="(row, index) in item.rows" v-bind:row=row v-bind:droppingRow="droppingRow" :key="row.id" v-on:row-delete="deleteRow" v-on:row-dragstart="onRowDragstart" v-on:row-dragend="onRowDragend" v-on:row-drop="onRowDrop" />          </transition-group>        </div>        <div class="ctl">          <button class="add" tabindex="-1" v-on:click.prevent="addRow">行の追加</button>        </div>      </div>      <div class="col3"><button v-on:click.prevent="onItemDelete" tabindex="-1"><span>削除</span></button></div>    </div>    <separator v-on:label-drop-on-separator="onLabelDrop" v-on:separator-click="onSeparatorClick" />  </div>',props:["item"],components:{row:{template:'  <div class="list-row-wrap">    <div class="row" v-bind:class="{dragging:dragging, focus:focus}" v-bind:draggable="draggable" v-on:dragstart="onRowDragstart" v-on:dragend="onRowDragend">      <label v-on:mouseover="onLabelMouseover" v-on:mouseout="onLabelMouseout"></label>      <input type="text" v-model="row.text" v-on:focus="onFocus" v-on:blur="onBlur" v-on:keydown.enter.prevent="" style="width:48%" placeholder="テキストを入力してください"/>      <input type="text" v-model="row.url" v-on:focus="onFocus" v-on:blur="onBlur" v-on:keydown.enter.prevent="" style="width:47%;padding-left:6px"  placeholder="URLを入力してください"/>      <button class="del" tabindex="-1" v-on:click.prevent="onRowDelete" style="margin-left: 0.5rem;"></button>    </div>    <listSeparator v-bind:droppingRow="droppingRow" v-on:row-drop="onRowDrop" />  </div>',props:["row","droppingRow"],components:{listSeparator:E},data:function(){return{dragging:!1,draggable:!1,focus:!1}},methods:{onRowDelete:function(){this.$emit("row-delete",this.row)},onLabelMouseover:function(){this.draggable=!0},onLabelMouseout:function(){this.draggable=!1},onRowDragstart:function(t){t.dataTransfer.setData("text","element"),t.dataTransfer.effectAllowed="move",this.dragging=!0,this.$emit("row-dragstart",this.row)},onRowDragend:function(t){this.dragging=!1,this.$emit("row-dragend",this.row)},onRowDrop:function(t){this.dragging=!1,this.$emit("row-drop",this.row)},onFocus:function(){this.focus=!0},onBlur:function(){this.focus=!1}}},separator:d,listSeparator:E},data:function(){return{droppingRow:null}},mixins:[n],methods:{addRow:function(){var t=P();console.log(t),this.item.rows.push({component:"row",text:null,url:null,id:t}),console.log(this.item.rows)},deleteRow:function(t){return!(t.text&&!confirm("行を削除します。よろしいですか？"))&&-1!==(t=this.item.rows.indexOf(t))&&void(this.item.rows.length<=1?this.item.rows[0].text=null:this.item.rows.splice(t,1))},onRowDragstart:function(t){this.droppingRow=t},onRowDragend:function(t){this.droppingRow=null},onRowDrop:function(t){var e,i;return!!this.droppingRow&&(i=t?this.item.rows.indexOf(t)+1:0,e=this.item.rows.indexOf(this.droppingRow),this.droppingRow=null,i!==e)&&i!==e+1&&(e=this.item.rows.splice(e,1),i=t?this.item.rows.indexOf(t)+1:0,void this.item.rows.splice(i,0,e[0]))}}},T={template:'  <div class="item-wrap">    <div class="item text youtube">      <div class="col1">        <label v-on:dragstart="onLabelDragstart" v-on:dragend="onLabelDragend" draggable="true">{{labelName}}</label>      </div>      <div class="col2">        <div class="class-wrap" v-if="isCssClassEnabled">          <label :for="item.id+\'_css\'">CSSクラス</label>          <input type="text" v-model="item.className" :id="item.id+\'_css\'" />        </div>        <input type="text" v-model="item.text" v-on:input="onInput" ref="inputElement" />      </div>      <div class="col3"><button v-on:click.prevent="onItemDelete" tabindex="-1"><span>削除</span></button></div>    </div>    <separator v-on:label-drop-on-separator="onLabelDrop" v-on:separator-click="onSeparatorClick" />  </div>',props:["item"],components:{separator:d},mixins:[n],mounted:function(){var t,e=this.$refs.inputElement;document.createEvent?((t=document.createEvent("HTMLEvents")).initEvent("input",!0,!0),e.dispatchEvent(t)):(t=document.createEventObject(),e.fireEvent("oninput",t))},computed:{labelName:function(){return u.options.typeNames.youtube}},methods:{onInput:function(t){var e,i=window.getComputedStyle(t.target),o=i.lineHeight.split("px")[0];i.paddingTop.split("px")[0],i.paddingBottom.split("px")[0];if(t.target.scrollHeight>t.target.offsetHeight)t.target.style.height=t.target.scrollHeight+3+"px";else for(;;){if(e=t.target.style.height.split("px")[0],t.target.style.height=e-o+"px",t.target.scrollHeight>t.target.offsetHeight){t.target.style.height=t.target.scrollHeight+3+"px";break}break}}}},R={template:'  <div class="item-wrap">  <div class="item text" style="max-width:9%;float:left;"><div class="col1">    <label v-on:dragstart="onLabelDragstart" v-on:dragend="onLabelDragend" draggable="true">画像</label>  </div></div>    <div class="item image" style="width:38%;float:left;" v-bind:class="{\'ve-unload\': !item.veInited, nofile: !item.image1, dragover:dragover.image1,  dragging:dragging, focus:focus}" v-on:dragover.prevent.stop="onDragover($event,\'image1\')" v-on:dragleave="onDragleave($event,\'image1\')" v-on:drop.prevent.stop="onDrop($event,\'image1\')">      <div class="loading" v-if="isLoadingFile.image1"><div class="progress-wrap"><div class="progress" v-bind:style="{width: uploadProgress + \'%\'}"></div></div></div>      <div class="col2"  style="width:100%">        <div class="dnd" v-if="isDndSupported" v-on:dblclick="selectFile(\'image1\')">          <div class="msg">画像をドラッグ＆ドロップ<br>（最大ファイルサイズ:{{this.maxFileSize}}）</div>        </div>          <div class="img" v-bind:class="item.align">            <img v-bind:src="item.image1" v-on:dblclick="selectFile(\'image1\')" draggable="false" style="max-width:100%"/>          </div>        <div class="alt-wrap" v-if="isAltEnabled">          <input type="text" v-model="item.image1_alt" :id="item.image1_alt" style="width:100% !important" placeholder="altを入力してください" />        </div>        <button class="remove" tabindex="-1" v-on:click.prevent="onFileDelete(\'image1\')">画像をクリア</button>        <button class="uploader" tabindex="-1" v-on:click.prevent="selectFile(\'image1\')">アップロード済みの画像から選択</button>      </div>    </div>    <div class="item image"  style="width:38%;float:left;" v-bind:class="{\'ve-unload\': !item.veInited, nofile: !item.image2, dragover:dragover.image2, dragging:dragging, focus:focus}" v-on:dragover.prevent.stop="onDragover($event,\'image2\')" v-on:dragleave="onDragleave($event,\'image2\')" v-on:drop.prevent.stop="onDrop($event,\'image2\')">      <div class="loading" v-if="isLoadingFile.image2"><div class="progress-wrap"><div class="progress" v-bind:style="{width: uploadProgress + \'%\'}"></div></div></div>      <div class="col2"  style="width:100%">        <div class="dnd" v-if="isDndSupported" v-on:dblclick="selectFile(\'image2\')">          <div class="msg">画像をドラッグ＆ドロップ<br>（最大ファイルサイズ:{{this.maxFileSize}}）</div>        </div>          <div class="img" v-bind:class="item.align">            <img v-bind:src="item.image2" v-on:dblclick="selectFile(\'image2\')" draggable="false" style="max-width:100%"/>          </div>        <div class="alt-wrap" v-if="isAltEnabled">          <input type="text" v-model="item.image2_alt" :id="item.image2_alt" style="width:100% !important" placeholder="altを入力してください" />        </div>        <button class="remove" tabindex="-1" v-on:click.prevent="onFileDelete(\'image2\')">画像をクリア</button>        <button class="uploader" tabindex="-1" v-on:click.prevent="selectFile(\'image2\')">アップロード済みの画像から選択</button>      </div>    </div>    <div class="item text">      <div class="col3"><button v-on:click.prevent="onItemDelete" tabindex="-1"><span>削除</span></button></div>    </div>    <separator style="clear:both;" v-on:label-drop-on-separator="onLabelDrop" v-on:separator-click="onSeparatorClick" />  </div>',props:["item"],data:function(){return{randomID:[],dragover:{image1:!1,image2:!1},isDndSupported:!u.options.uploaderDomain,isLoadingFile:{image1:!1,image2:!1},uploadProgress:0,inputComponent:u.options.inlineVe?"visualeditor":"plaintexteditor",focus:!1,maxFileSize:u.options.maxFileSize}},components:{visualeditor:m,plaintexteditor:M,separator:d},mixins:[n],created:function(){},mounted:function(){for(var t=0;t<3;t++)this.randomID.push("image-align-"+P(6,"numeric"))},computed:{isAltEnabled:function(){return u.options.allowImageAlt}},methods:{canDrop:function(){return this.isDndSupported&&!a},selectFile:function(t){return this.current=t,F.showUploader(u.options.uploaderDomain,u.options.uploaderPath,u.options.uploaderDir,this.setImage),!1},setImage:function(t){var e=u.options.imageTypes;if(t&&e){var i=new RegExp(".("+e.join("|")+")$");if(!t.match(i))return alert("画像の種類は "+e.join("・")+" のいずれかである必要があります"),!1}this.$set(this.item,this.current,t),this.current=void 0},onFileDelete:function(t){if(!confirm("画像をクリアします。よろしいですか？\n(アップロードされたファイルは削除されません)"))return!1;this.current=t,this.setImage(null)},onVEInit:function(){this.item.veInited=!0},onDragover:function(t,e){if(!this.canDrop())return!1;t.dataTransfer.dropEffect="copy",this.$set(this.dragover,e,!0)},onDragleave:function(t,e){if(!this.canDrop())return!1;this.$set(this.dragover,e,!1)},onDrop:function(t,e){if(!this.canDrop())return!1;this.current=e;var i,o=this,t=(this.$set(this.dragover,e,!1),this.$set(this.isLoadingFile,e,!0),this.uploadProgress=0,t.dataTransfer.files),n="",t=(0==(file_count=t.length)?n="画像が指定されていません":1<file_count&&(n="アップロードできる画像は1個までです"),t[0]),a=(!n&&t.size>O(u.options.maxFileSize)&&(n="画像のサイズが上限("+u.options.maxFileSize+")を超過しています"),u.options.imageTypes);if(!n&&a&&(i=new RegExp(".("+a.join("|")+")$"),t.name.match(i)||(n="画像の種類は "+a.join("・")+" のいずれかである必要があります")),n)return this.$set(this.isLoadingFile,e,!1),alert(n),!1;F.upload.call(this,t,u.options.uploaderPath,u.options.uploaderDir,function(t){o.$set(o.isLoadingFile,e,!1),o.setImage(t)},function(t){o.$set(o.isLoadingFile,e,!1),alert(t)},function(t){o.uploadProgress=100*t})},onFocus:function(){this.focus=!0},onBlur:function(){this.focus=!1}}},N={"big-heading":{type:"big-heading",component:"textItem",id:null,text:null},"mid-heading":{type:"mid-heading",component:"textItem",id:null,text:null},"small-heading":{type:"small-heading",component:"textItem",id:null,text:null},text:{type:"text",component:"textItem",id:null,text:""},"ve-text":{component:"VETextItem",align:"left",id:null,text:"",veInited:!1},image:{component:"imageItem",align:"left",image:null,text:null,id:null,veInited:!1},"image-kmu":{component:"imageKmuItem",align:"left",image:null,text:null,id:null,veInited:!1},link:{component:"linkItem",url:null,text:null,id:null,newWindow:!1},"link-kmu":{component:"linkKmuItem",id:null,links:[{url:null,text:null,newWindow:!1},{url:null,text:null,newWindow:!1}]},list:{component:"listKmuItem",rows:[{component:"row",text:null,id:null}],isLink:!1},"list-kmu":{component:"listKmuItem",rows:[{component:"row",text:null,id:null}],isLink:!0},"list-link-kmu":{component:"listLinkKmuItem",rows:[{component:"row",text:null,id:null}],isLink:!0},table:{component:"tableItem",rows:[],id:null},html:{component:"htmlItem",html:null,id:null},youtube:{component:"youtubeItem",id:null,text:null},"vs-image":{component:"VSImageItem",align:"left",image:null,text:null,id:null,veInited:!1}},E=i.val(),L=i.attr("name"),S=[],M=((m=$("<div></div>")).html(E),m.find("."+u.options.wholeWrapTagClass).children().each(function(){var t,e,i,o,n,a,s,l,r,d=$(this),p=d.html(),c=d[0].tagName.toUpperCase();c===u.options.bigHeadingTag.toUpperCase()||c===u.options.midHeadingTag.toUpperCase()||c===u.options.smallHeadingTag.toUpperCase()||c===u.options.textTag.toUpperCase()&&!u.options.inlineVe?(0<=u.options.types.indexOf("big-heading")&&c===u.options.bigHeadingTag.toUpperCase()?t="big-heading":0<=u.options.types.indexOf("mid-heading")&&c===u.options.midHeadingTag.toUpperCase()?t="mid-heading":0<=u.options.types.indexOf("small-heading")&&c===u.options.smallHeadingTag.toUpperCase()?t="small-heading":0<=u.options.types.indexOf("text")&&c===u.options.textTag.toUpperCase()&&(t="text"),-1!==u.options.types.indexOf(t)&&(p=(r=p)&&r.replace(/<br(\s*\/)?>/g,"\n"),u.options.allowHtmlInText||(p=A(p)),(l=W(N[t])).id=P(),l.text=p,u.options.allowCssClass&&(s=d.attr("class"))&&(l.className=s.trim()),S.push(l))):c===u.options.textTag.toUpperCase()&&u.options.inlineVe?-1!==u.options.types.indexOf("text")&&((l=W(N["ve-text"])).id=P(),l.text=p,u.options.allowCssClass&&(s=d.attr("class"))&&(l.className=s.trim()),l.align="left",d.hasClass("right")&&(l.align="right"),d.hasClass("center")&&(l.align="center"),S.push(l)):c===u.options.imageTag.toUpperCase()&&d.hasClass(u.options.imageTagClass)?-1!==u.options.types.indexOf("image")&&(e=d.find(".img").eq(0),l=W(N.image),e.length&&(e.hasClass("img-left")&&(l.align="left"),e.hasClass("img-right")&&(l.align="right"),e.hasClass("img-center")&&(l.align="center"),(i=e.find("img").eq(0))&&(l.image=i.attr("src")),n=null,(o=d.find(".text").eq(0)).length)&&(n=o.html(),n=(n=!u.options.inlineVe&&u.options.allowHtmlInText?U(n):n).replace(/&lt;br(\s*\/)?&gt;/g,"<br>"),l.text=n),u.options.allowCssClass&&(s=(s=d.attr("class"))&&s.replace(u.options.imageTagClass,"").trim())&&(l.className=s),u.options.allowImageAlt&&(r=i.attr("alt"),l.altName=r||null),l.id=P(),S.push(l)):c===u.options.imageTag.toUpperCase()&&d.hasClass("imageCol")&&0<d.find(".imageCol__image").length?-1!==u.options.types.indexOf("image-kmu")&&(l=W(N["image-kmu"]),(i=(e=d.find(".imageCol__image").eq(0)).find("img").eq(0))&&(l.image=i.attr("src")),n=null,(o=d.find(".imageCol__text").eq(0)).length&&(n=o.html(),n=(n=!u.options.inlineVe&&u.options.allowHtmlInText?U(n):n).replace(/&lt;br(\s*\/)?&gt;/g,"<br>"),l.text=n),l.heading=d.find(".imageCol__title:eq(0)").text(),l.link_url=d.find(".imageCol__button a:eq(0)").attr("href"),l.link_text=d.find(".imageCol__button a:eq(0)").text(),l.id=P(),S.push(l)):c===u.options.linkTag.toUpperCase()&&d.hasClass(u.options.linkTagClass)?-1!==u.options.types.indexOf("link")&&((l=W(N.link)).url=d.find("a").eq(0).attr("href"),l.text=d.find("a").eq(0).text(),l.newWindow="_blank"===d.find("a").eq(0).attr("target"),l.id=P(),u.options.allowCssClass&&(s=(s=d.attr("class"))&&s.replace(u.options.linkTagClass,"").trim())&&(l.className=s),S.push(l)):c===u.options.linkTag.toUpperCase()&&d.hasClass("buttonCol")?-1!==u.options.types.indexOf("link-kmu")&&(l=W(N["link-kmu"]),d.find("a").each(function(t){l.links[t].url=$(this).attr("href"),l.links[t].text=$(this).text(),l.links[t].newWindow="_blank"===$(this).attr("target")}),l.id=P(),u.options.allowCssClass&&(s=(s=d.attr("class"))&&s.replace(u.options.linkTagClass,"").trim())&&(l.className=s),S.push(l)):c===u.options.listTag.toUpperCase()&&d.hasClass("listTypeA")?-1!==u.options.types.indexOf("list-kmu")&&(l=W(N["list-kmu"]),a=[],d.find("li").each(function(){var t=($e=$(this)).find("span:eq(0)").text(),e="";0<$e.find("a").length&&(e=$e.find("a").attr("href")),a.push({component:"row",text:t,url:e,id:P()})}),0===a.length&&(l.rows[0].id=P(),a=l.rows),l.rows=a,l.id=P(),u.options.allowCssClass&&(s=d.attr("class"))&&(l.className=s.trim()),S.push(l)):c===u.options.listTag.toUpperCase()&&d.hasClass("arrowLinkList")?-1!==u.options.types.indexOf("list-link-kmu")&&(l=W(N["list-link-kmu"]),a=[],d.find("li").each(function(){var t=($e=$(this)).find("span:eq(0)").text(),e="";0<$e.find("a").length&&(e=$e.find("a").attr("href")),a.push({component:"row",text:t,url:e,id:P()})}),0===a.length&&(l.rows[0].id=P(),a=l.rows),l.rows=a,l.id=P(),S.push(l)):c===u.options.listTag.toUpperCase()?-1!==u.options.types.indexOf("list")&&(l=W(N.list),a=[],d.find("li").each(function(){var t;$e=$(this),t=u.options.allowHtmlInText?$e.html():$e.text(),a.push({component:"row",text:t,id:P()})}),0===a.length&&(l.rows[0].id=P(),a=l.rows),l.rows=a,l.id=P(),u.options.allowCssClass&&(s=d.attr("class"))&&(l.className=s.trim()),S.push(l)):c===u.options.tableTag.toUpperCase()?-1!==u.options.types.indexOf("table")&&(l=W(N.table),a=[],d.find("tr").each(function(){var e={cols:[]};$(this).find("th,td").each(function(){var t=$(this).html(),t={text:t=(t=!u.options.inlineVe&&u.options.allowHtmlInText?U(t):t).replace(/&lt;br(\s*\/)?&gt;/g,"<br>")};"TH"==$(this)[0].tagName.toUpperCase()?t.header=!0:t.header=!1,e.cols.push(t)}),a.push(e)}),l.rows=a,l.id=P(),u.options.allowCssClass&&(s=d.attr("class"))&&(l.className=s.trim()),S.push(l)):c===u.options.htmlTag.toUpperCase()&&d.hasClass(u.options.htmlTagClass)?-1!==u.options.types.indexOf("html")&&(l=W(N.html),u.options.allowCssClass&&(s=(s=d.attr("class"))&&s.replace(u.options.htmlTagClass,"").trim())&&(l.className=s),l.html=d.html(),l.id=P(),S.push(l)):d.hasClass("movie")?-1!==u.options.types.indexOf("youtube")&&(l=W(N.youtube),p=d.find("iframe").attr("src"),l.id=P(),l.text=p,S.push(l)):c===u.options.imageTag.toUpperCase()&&d.hasClass("imageCol")&&(l=W(N["vs-image"]),d.find("img").length&&(l.image1=d.find("img").eq(0).attr("src"),l.image2=d.find("img").eq(1).attr("src")),l.id=P(),S.push(l))}),this.getSendData=function(){for(var e="",t=0;t<S.length;t++){var i,s,l,r,o,n=S[t];if("textItem"===n.component){var a,d=q(d=n.text);u.options.allowHtmlInText||(d=U(d)),(d=(a=d)&&a.replace(/(\r\n|\r|\n)/g,"<br>"))&&(a=u.options.textTag,"big-heading"===n.type?a=u.options.bigHeadingTag:"mid-heading"===n.type?a=u.options.midHeadingTag:"small-heading"===n.type?a=u.options.smallHeadingTag:"text"===n.type&&(a=u.options.textTag),c="",e+="<"+a+(c=u.options.allowCssClass&&n.className?' class="'+U(n.className.trim())+'"':c)+">"+d+"</"+a+">\n")}else if("VETextItem"===n.component)(d=j(n.text))&&(c="","left"!==n.align&&(c=' class="'+U(n.align)+'"'),u.options.allowCssClass&&n.className&&(c=' class="'+U(n.className.trim())+'"'),e+="<"+u.options.textTag+c+">\n"+d+"\n</"+u.options.textTag+">\n");else if("imageItem"===n.component)n.image&&(d=j(n.text),!u.options.inlineVe&&u.options.allowHtmlInText&&(d=A(d)),c="",u.options.allowCssClass&&n.className&&(c=" "+U(n.className.trim())),a="",u.options.allowImageAlt&&n.altName&&(a=' alt="'+U(n.altName)+'"'),e+="<"+u.options.imageTag+' class="'+u.options.imageTagClass+c+'">\n<p class="img img-'+n.align+'"><img src="'+n.image+'" title="'+n.image+'"'+a+' /></p>\n<p class="text">'+d+"</p>\n</"+u.options.imageTag+">\n");else if("imageKmuItem"===n.component)n.image&&(d=j(n.text),!u.options.inlineVe&&u.options.allowHtmlInText&&(d=A(d)),e=e+('<div class="imageCol"><div class="imageCol__image"><img src="'+n.image)+'" alt=""></div><div class="imageCol__body">',n.heading&&(e+='<h3 class="imageCol__title">'+n.heading+"</h3>"),d&&(e+='<p class="imageCol__text">'+d+"</p>"),n.link_url&&n.link_text&&(e+='<p class="imageCol__button"><a href="'+n.link_url+'" class="buttonA">'+n.link_text+"</a></p>"),e+="</div></div>\n");else if("linkItem"===n.component)n.url&&(p=U(n.url),d=(d=U(n.text))||p,c="",u.options.allowCssClass&&n.className&&(c=" "+U(n.className.trim())),e+="<"+u.options.linkTag+' class="'+u.options.linkTagClass+c+'">\n<a href="'+p+'"'+(n.newWindow?' target="_blank" rel="noopener"':"")+">"+d+"</a>\n</"+u.options.linkTag+">\n");else if("linkKmuItem"===n.component){if(0!==n.links.length){var p,c="";u.options.allowCssClass&&n.className&&(c=" "+U(n.className.trim())),e+="<"+u.options.linkTag+' class="buttonCol'+c+'">\n';for(let t=0;t<n.links.length;t++)null!==n.links[t].url&&""!==n.links[t].url&&(p=U(n.links[t].url),d=(d=U(n.links[t].text))||p,e+='<p class="buttonCol__item">\n<a href="'+p+'"'+(n.links[t].newWindow?' target="_blank" rel="noopener"':"")+' class="buttonA">'+d+"</a></p>\n");e+="</"+u.options.linkTag+">\n"}}else"listItem"===n.component?(i="",n.rows.forEach(function(t){t.text&&(t=t.text,u.options.allowHtmlInText||(t=U(t)),i+="<li>"+t+"</li>\n")}),i&&(c="",u.options.allowCssClass&&n.className&&(c=' class="'+U(n.className.trim())+'"'),e+="<"+u.options.listTag+c+">\n"+i+"</"+u.options.listTag+">\n")):"listKmuItem"===n.component?(i="",n.rows.forEach(function(t){var e;t.text&&(e=t.text,u.options.allowHtmlInText||(e=U(e)),i+='<li class="listTypeA__item"><span>'+e+"</span>",t.url&&(i+='<a href="'+t.url+'" class="listTypeA__link">疾患の解説</a>'),i+="</li>\n")}),i&&(e+="<"+u.options.listTag+(c=' class="listTypeA -pcCol2"')+">\n"+i+"</"+u.options.listTag+">\n")):"listLinkKmuItem"===n.component?(i="",n.rows.forEach(function(t){var e;t.text&&t.url&&(e=t.text,u.options.allowHtmlInText||(e=U(e)),i+='<li class="arrowLinkList__item"><a href="'+t.url+'"><span>'+e+"</span></a></li>\n")}),i&&(c=" ",e+="<"+u.options.listTag+' class="arrowLinkList">\n'+i+"</"+u.options.listTag+">\n")):"tableItem"===n.component?(l=s=o="",r=0,n.rows.forEach(function(t){var i=[],o=0,n=0,a="";t.cols.forEach(function(t){var e=j(t.text);t.header&&o++,e||n++}),t.cols.length!=n&&(a=t.cols.length==o?"col":"row",t.cols.forEach(function(t){var e=j(t.text);!u.options.inlineVe&&u.options.allowHtmlInText&&(e=A(e)),t.header?i.push('<th scope="'+a+'">'+e+"</th>\n"):i.push("<td>"+e+"</td>\n")}),t="",t=(t+="<tr>\n")+i.join("")+"</tr>\n",0==r&&"col"==a?s+=t:l+=t,r++)}),s&&(o+="<thead>\n"+s+"</thead>\n"),l&&(o+="<tbody>\n"+l+"</tbody>\n"),o&&(c="",u.options.allowCssClass&&n.className&&(c=' class="'+U(n.className.trim())+'"'),e+="<"+u.options.tableTag+c+">\n"+o+"</"+u.options.tableTag+">\n")):"htmlItem"===n.component?(o=q(o=n.html))&&(c="",u.options.allowCssClass&&n.className&&(c=" "+U(n.className.trim())),e+="<"+u.options.htmlTag+' class="'+u.options.htmlTagClass+c+'">'+o+"</"+u.options.htmlTag+">\n"):"youtubeItem"===n.component?(d=n.text)&&d.startsWith("https://www.youtube.com/")&&(e=(e+='<div class="movie">')+'<iframe width="560" height="315" src="'+d+'" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>'):"VSImageItem"===n.component&&(n.image1||n.image2)&&(e+='<div class="imageCol">',n.image1&&(e+='<div><img src="'+n.image1+'" alt="'+(void 0===n.image1_alt?"":n.image1_alt)+'"></div>'),n.image2&&(e+='<div><img src="'+n.image2+'" alt="'+(void 0===n.image2_alt?"":n.image2_alt)+'"></div>'),e+="</div>")}return e=e&&"<"+u.options.wholeWrapTag+' class="'+u.options.wholeWrapTagClass+'">\n'+e+"</"+u.options.wholeWrapTag+">\n"},[]);function _(){var t;u.vue||(u.vue=new Vue({el:e,template:'        <div class="article-editor" v-on:dragover.prevent.stop="onFileDrag">          <separator v-on:label-drop-on-separator="onItemDrop" v-on:separator-click="onSeparatorClick" />          <transition name="tips" tag="div">          <div class="tips" v-if="!items.length"><div class="separator" v-on:click.prevent=""><button tabindex="-1"><span>挿入</span></button></div>をクリックすると{{tipsLabel}}</div>          </transition>          <transition-group name="item" tag="div">            <component v-bind:is="item.component" v-for="(item, index) in items" :key="item.id" v-bind:item=item v-on:item-delete="deleteItem" v-on:separator-click="onSeparatorClick" v-on:item-dragstart="onItemDragstart" v-on:item-dragend="onItemDragend" v-on:item-drop="onItemDrop" v-on:table-header-menu-click="onTableHeaderMenuClick" />          </transition-group>          <tableMenu v-bind:data="tableMenu" v-on:menu-click="doTableAction" ref="tableMenu" />          <itemMenu v-bind:data="itemMenu" v-on:menu-click="addItem" ref="itemMenu" />          <input v-bind:name="inputName" type="hidden" ref="sendData" />        </div>',data:function(){return{items:[],itemMenu:{show:!1,position:{x:0,y:0},size:{width:0,height:0}},tableMenu:{show:!1,direction:null,mode:"row"},inputName:null,tipsLabel:null}},components:{separator:d,itemMenu:c,tableMenu:b,textItem:g,VETextItem:v,imageItem:h,imageKmuItem:C,linkItem:f,linkKmuItem:k,listItem:w,listKmuItem:y,listLinkKmuItem:I,tableItem:x,htmlItem:D,youtubeItem:T,VSImageItem:R},created:function(){this.items=S,this.inputName=L;var e=[];u.options.types.forEach(function(t){e.push(u.options.typeNames[t])}),this.tipsLabel=1===e.length?"その位置に"+e[0]+"が追加されます。":"その位置に選んだ要素（"+e.join("・")+"）が追加されます。"},mounted:function(){var t=$(this.$el).closest("form"),i=this;t&&t.bind("submit",function(t){var e=u.getSendData();$(i.$refs.sendData).val(e)}),u.options.onLoad&&u.options.onLoad.call(u),u.options.onUpdate&&u.options.onUpdate.call(u)},methods:{addItem:function(t){"text"===t&&u.options.inlineVe&&(t="ve-text");var e=s?this.items.indexOf(s)+1:0,i=W(N[t]);"list"!==t&&"list-kmu"!==t&&"list-link-kmu"!==t||(i.rows[0].id=P()),i.id=P(),this.items.splice(e,0,i),s=null},deleteItem:function(t){if(!confirm("要素を削除します。よろしいですか？"))return!1;t=this.items.indexOf(t);-1!==t&&this.items.splice(t,1)},onSeparatorClick:function(t,e){var i,o,n;s=t,this.itemMenu.show=!1,1===u.options.types.length?this.addItem(u.options.types[0]):(this.itemMenu.show=!0,this.itemMenu.direction="below",t=$(this.$refs.itemMenu.$el),n=$(this.$el),i=e.pageX-n.offset().left,o=e.pageY-n.offset().top,i-=t.outerWidth()/2,e.pageX-t.outerWidth()/2<0&&(i=-1*n.offset().left),(n=e.pageX+t.outerWidth()/2)>$(document).width()&&(i-=n-$(document).width()),e.pageY+t.outerHeight()+30>$(document).height()&&(o-=t.outerHeight(),this.itemMenu.direction="above"),"above"==this.itemMenu.direction?o-=15:o+=30,t.css({left:i+"px",top:o+"px"}),$(document).bind("click",this.hideItemMenu))},hideItemMenu:function(){this.itemMenu.show=!1,s=null,$(document).unbind("click",this.hideItemMenu)},doTableAction:function(t){l&&l.doAction(t),l=null},onTableHeaderMenuClick:function(t,e,o){$(document).unbind("click",this.hideTableMenu),l=t,this.tableMenu.show=!0,this.tableMenu.mode=e,this.tableMenu.direction="above";var n=$(this.$refs.tableMenu.$el),a=$(this.$el),s=this;setTimeout(function(){V({pageX:o.pageX,pageY:o.pageY,menuH:n.height()});var t,e=o.pageX-a.offset().left,i=o.pageY-a.offset().top-n.height();e-=n.outerWidth()/2,o.pageX-n.outerWidth()/2<0&&(e=-1*a.offset().left),(t=o.pageX+n.outerWidth()/2)>$(document).width()&&(e-=t-$(document).width()),o.pageY-n.outerHeight()<0&&(i+=n.outerHeight(),s.tableMenu.direction="below"),"above"==s.tableMenu.direction?i-=25:i+=20,n.css({left:e+"px",top:i+"px"}),s.tableMenu.show=!0,$(document).bind("click",s.hideTableMenu)},0)},hideTableMenu:function(){this.tableMenu.show=!1,$(document).unbind("click",this.hideTableMenu),l&&l.doAction(null),l=null},onFileDrag:function(t){t.dataTransfer.dropEffect="none"},onItemDragstart:function(t){a=t},onItemDragend:function(t){a=null},onItemDrop:function(t){var e,i;return!!a&&(i=t?this.items.indexOf(t)+1:0,e=this.items.indexOf(a),a=null,i!==e)&&i!==e+1&&(e=this.items.splice(e,1),i=t?this.items.indexOf(t)+1:0,void this.items.splice(i,0,e[0]))}}}),u.options.onUpdate&&(t=null,u.vue.$watch("items",function(){t&&clearTimeout(t),t=setTimeout(function(){u.options.onUpdate.call(u)},u.options.updateInterval)},{deep:!0})))}"undefined"==typeof Vue&&M.push([H+"lib/vue/vue.min.js"]),M.length?B(M,function(){_()},function(){alert("ライブラリの読み込みに失敗しました")}):_()}var e=!0,H=function(){{var t;t=(document.currentScript||(t=document.getElementsByTagName("script"),t=t[t.length-1])).src}if(t&&t.match(/^(.+?)([^\/]+?)$/))return RegExp.$1}(),t=window.File&&window.FileReader&&window.FileList&&window.Blob,i=-1!==(i=window.navigator.userAgent.toLowerCase()).indexOf("edge")?"edge":-1!==i.indexOf("iemobile")?"iemobile":-1!==i.indexOf("trident/7")||-1!==i.indexOf("msie")&&-1===i.indexOf("opera")?"ie":-1!==i.indexOf("chrome")&&-1===i.indexOf("edge")?"chrome":-1!==i.indexOf("safari")&&-1===i.indexOf("chrome")?"safari":-1!==i.indexOf("opera")?"opera":-1!==i.indexOf("firefox")?"firefox":null,n=("edge"==i||"chrome"==i||"safari"==i||"firefox"==i||"ie"==i&&10<=function(){var t=window.navigator.userAgent.toLowerCase(),e=window.navigator.appVersion.toLowerCase();if(-1!==t.indexOf("trident/7"))return 11;if(-1!==t.indexOf("msie")&&-1===t.indexOf("opera")){if(-1!==e.indexOf("msie 6."))return 6;if(-1!==e.indexOf("msie 7."))return 7;if(-1!==e.indexOf("msie 8."))return 8;if(-1!==e.indexOf("msie 9."))return 9;if(-1!==e.indexOf("msie 10."))return 10}return null}())&&t,a=(o(H+"css/style.css"),o(H+"css/ve.css"),o(H+"css/vue-transition.css"),o(H+"lib/font-awesome/font-awesome.min.css"),null);function P(t,e){void 0===t&&(t=8),"alphanumeric"===(e=void 0===e?"alphanumeric":e)?i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789":"numeric"===e&&(i="0123456789");for(var i,o=i.length,n="",a=0;a<t;a++)n+=i[Math.floor(Math.random()*o)];return n}function O(t){var e=["B","KB","MB","GB","TB","PB"],t=t.toUpperCase(),i=e.join("|"),i=new RegExp("^(([1-9]\\d*|0)(\\.\\d+)?)\\s*("+i+"?)$");return t.match(i)?(t=RegExp.$1,i=RegExp.$4,e=e.indexOf(i),Math.floor(t*Math.pow(1024,e))):null}function U(t){return t&&t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace("/ /","&nbsp;")}function q(t){return t&&t.replace(/<script(\s+.+?)?>(.+?)<\/script(\s+.?)?>/g,"").replace(/<div(\s+.+?)?>(.+?)<\/div(\s+.?)?>/g,"")}function A(t){return t&&t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&nbsp;/g,"")}function j(t){return t=t&&(t=(t=t.replace(/(<div.*?>|<p.*?>)/gi,"<br>")).replace(/(<\/div\s*>|<\/p\s*>)/gi,"")).replace(/^<br(\s+[^>]+)?(\s*\/)?>/i,"")}function P(t,e){void 0===t&&(t=8),"alphanumeric"===(e=void 0===e?"alphanumeric":e)?i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789":"numeric"===e&&(i="0123456789");for(var i,o=i.length,n="",a=0;a<t;a++)n+=i[Math.floor(Math.random()*o)];return n}function o(t){var e=document.getElementsByTagName("head").item(0),i=document.createElement("link");i.rel="stylesheet",i.href=t,i.type="text/css",e.appendChild(i)}F.showUploader=function(i,t,e,o){if(a)return!1;(i=i||"")&&(t=i+t),e&&(t+="#"+e),(a=$('<div class="article-editor-overlay"><div class="uploader"><button class="close"><i class="fa fa-times" aria-hidden="true"></i></button><iframe src="'+t+'"></iframe></div></div>')).addClass("active").bind("click",F.hideUploader),$("body").append(a),window.selectUploadFile||(window.selectUploadFile=function(t){o&&o(i+t),F.hideUploader()}),window.onmessage||(window.onmessage=function(t){try{var e=JSON.parse(t.data);void 0!==e.path&&o&&o(i+e.path)}catch(t){}F.hideUploader()})},F.hideUploader=function(){if(!a)return!1;a.removeClass("active"),window.selectUploadFile=null,window.onmessage=null,setTimeout(function(){a.remove(),a=null},500)},F.upload=function(t,e,i,o,n,a){var s=new FormData,l=(s.append("dir",i),s.append("action","upload"),s.append("upload",t),new XMLHttpRequest);l.open("POST",e),l.setRequestHeader("X-REQUESTED-WITH","XMLHttpRequest"),l.onreadystatechange=function(t){if(l.readyState===XMLHttpRequest.DONE&&200===l.status)try{var e=JSON.parse(l.response);if(e.errors)return n&&n(e.errors),!1;o&&o(e.result.files[0].web_path)}catch(t){n&&n("不正なデータを受信しました")}},l.upload.onprogress=function(t){a&&a(t.loaded/t.total)},l.send(s)};var d=[];function B(n,a,t){var s,l,r=[];(n="string"==typeof n?[n]:n).forEach(function(t){-1===d.indexOf(n)&&r.push(t)}),0===r.length?a&&a():(s=setTimeout(function(){t&&t()},5e3),l=0,r.forEach(function(e){var i=document.getElementsByTagName("head").item(0),o=document.createElement("script");o.src=e,i.appendChild(o),d.push(e),o.onload=function(){++l===r.length&&(clearTimeout(s),a)&&a(n);var t=d.indexOf(e);-1!==t&&d.splice(t,1),o.onload=null,i&&o.parentNode&&i.removeChild(o)}}))}function W(t){return JSON.parse(JSON.stringify(t))}function V(t){e&&("undefined"==typeof console||void 0===console.log?console={}:console.log(t))}return function(e,i){if(!n)return alert("[ArticleEditor] お使いのブラウザはサポートされていません"),null;function t(){var t;o.instances=[],e instanceof HTMLElement?(t=new F(e,i),o.instances.push(t)):$(e).each(function(){var t=new F($(this)[0],i);o.instances.push(t)})}var o=this;"undefined"==typeof jQuery?B([H+"lib/jquery/jquery.min.js"],function(){t()}):t()}}();